<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cyberpunk-Flappy</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700;800&display=swap" rel="stylesheet">
</head>

<body>
  <div id="game-container">
    <canvas id="game" width="1280" height="720"></canvas>

    <div class="ui-layer">
      <!-- Main HUD (will be moved) -->

      <div id="bonus-notification" class="bonus-popup">
        <div class="bonus-title">PHASE REWARD</div>
        <div class="bonus-amount">+10 CREDITS</div>
      </div>

      <!-- Settings Panel -->
      <div id="settings-panel" class="modal-panel compact-settings">
        <span class="close-modal">&times;</span>
        <h2>SYSTEM CONFIG</h2>

        <div class="settings-content">
          <div class="setting-row">
            <span class="setting-label">Music</span>
            <input type="range" id="bgmVolumeRange" min="0" max="1" step="0.1">
            <button id="toggle-bgm" class="btn-toggle">ON</button>
          </div>
          <div class="setting-row">
            <span class="setting-label">Sound FX</span>
            <input type="range" id="sfxVolumeRange" min="0" max="1" step="0.1">
            <button id="toggle-sfx" class="btn-toggle">ON</button>
          </div>
          <div class="setting-row">
            <span class="setting-label">System Hub</span>
            <div class="selector-group">
              <button id="mode-touch" class="selector-btn">TOUCH</button>
              <button id="mode-left" class="selector-btn">DASH<br>LEFT</button>
              <button id="mode-right" class="selector-btn">DASH<br>RIGHT</button>
              <button id="mode-fps" class="selector-btn">FPS</button>
            </div>
          </div>

          <div class="divider"></div>

          <div class="setting-row">
            <span class="setting-label">Core Speed</span>
            <input type="range" id="speedRange" min="1" max="25" step="0.5">
            <span id="val-speed" class="val-display">2</span>
          </div>
          <div class="setting-row">
            <span class="setting-label">Gravity</span>
            <input type="range" id="gravityRange" min="0.05" max="2.0" step="0.01">
            <span id="val-gravity" class="val-display">0.15</span>
          </div>
          <div class="setting-row">
            <span class="setting-label">Lift Force</span>
            <input type="range" id="liftRange" min="3" max="30" step="0.5">
            <span id="val-lift" class="val-display">6</span>
          </div>
          <div class="setting-row">
            <span class="setting-label">Gap Width</span>
            <input type="range" id="gapRange" min="150" max="400" step="10">
            <span id="val-gap" class="val-display">250</span>
          </div>
          <div class="setting-row">
            <span class="setting-label">Pipe Spacing</span>
            <input type="range" id="spacingRange" min="200" max="600" step="10">
            <span id="val-spacing" class="val-display">250</span>
          </div>
        </div>

        <div class="modal-footer">
          <button id="resetDefaultsBtn" class="btn-secondary">DEFAULT</button>
          <button id="applySettingsBtn" class="btn-primary">MENU</button>
        </div>
        <div class="version-tag">V1.02</div>
      </div>

      <!-- Shop Panel -->
      <div id="shop-panel" class="modal-panel full-shop">
        <span class="close-modal">&times;</span>
        <h2>CYBER SHOP</h2>

        <div class="shop-tabs">
          <div class="shop-tab active" data-tab="skins">SKINS</div>
          <div class="shop-tab" data-tab="boosts">BOOSTS</div>
        </div>

        <div class="shop-balance">
          <div>CREDITS: <span id="shop-balance">0</span></div>
          <div class="skins-count">SKINS OWNED: <span id="owned-skins-count">0</span>/<span
              id="total-skins-count">0</span></div>
        </div>
        <div class="shop-main-layout">
          <div class="shop-grid" id="shop-grid"></div>
        </div>
        <div id="shop-pagination" class="pagination-container"></div>
        <div id="shop-msg"
          style="color: var(--neon-red); text-align: center; font-size: 0.8rem; margin-top: 0.5rem; font-weight: 700;">
        </div>
      </div>

      <div id="confirm-modal" class="modal-panel confirm-dialog">
        <h2 id="confirm-title">PURCHASE</h2>
        <p id="confirm-msg"></p>
        <div id="confirm-qty-container" style="display: none; margin: 1rem 0;">
          <span class="qty-label">QUANTITY:</span>
          <input type="number" id="confirm-qty-input" value="1" min="1" max="99" class="qty-input">
        </div>
        <div class="modal-footer">
          <button id="confirm-cancel" class="btn-secondary">CANCEL</button>
          <button id="confirm-ok" class="btn-primary">CONFIRM</button>
        </div>
      </div>

      <div id="security-modal" class="modal-panel confirm-dialog security-alert">
        <h2 style="color: var(--neon-red);">SECURITY ALERT</h2>
        <p id="security-msg">Local data has been modified illegally. For your safety, credits and progress have been
          restored from the last secure backup.</p>
        <div class="modal-footer">
          <button id="security-ok" class="btn-primary" style="border-color: var(--neon-red); color: var(--neon-red);">I
            UNDERSTAND</button>
        </div>
      </div>

      <!-- Splash Screen (Landing) -->
      <div id="splash-screen" class="screen-overlay splash-active">
        <div class="splash-content">
          <div id="play-btn" class="main-play-btn">PLAY</div>
        </div>
      </div>

      <div id="main-hud">
        <!-- HUD (High positioning) -->
        <div id="top-hud">
          <div id="coin-display">
            <span class="coin-icon">$</span> <span id="total-coins">0</span>
          </div>

          <div id="score-container">
            <div id="score">0</div>
          </div>

          <div id="action-buttons">
            <div id="fullscreen-btn" class="btn-icon">‚õ∂</div>
            <div id="shop-btn" class="btn-icon">üõçÔ∏è</div>
            <div id="settings-btn" class="btn-icon">‚öô</div>
          </div>
          <div id="fps-display" class="fps-text">60 FPS</div>
        </div>

        <div id="energy-bar-hud">
          <span id="energy-label">Nitro System</span>
          <div id="energy-container">
            <div id="energy-fill"></div>
          </div>
        </div>

        <div id="dash-btn-container" class="dash-btn-wrapper">
          <button id="dash-btn" class="dash-button-hud">DASH</button>
        </div>
      </div>

      <!-- Start & Map Selection Screen -->
      <div id="start-screen" class="screen-overlay" style="display: none;">
        <!-- Game Mode Selection -->
        <h3 class="mode-label">GAME MODE</h3>
        <div class="mode-selector-container">
          <div class="mode-option" data-mode="classic">CLASSIC</div>
          <div class="mode-option active" data-mode="advance">ADVANCE</div>
        </div>

        <div class="map-selector-container">
          <div class="map-option active" data-map="5" data-name="Sunny Highlands">‚òÄÔ∏è</div>
          <div class="map-option" data-map="0" data-name="Neon City">üèôÔ∏è</div>
          <div class="map-option" data-map="1" data-name="Techno Jungle">üéã</div>
          <div class="map-option" data-map="2" data-name="Ocean Abyss">ü´ß</div>
          <div class="map-option" data-map="3" data-name="Volcano Core">üåã</div>
          <div class="map-option" data-map="4" data-name="Star Forge">‚ú®</div>
        </div>
        <div id="selected-theme-name">SUNNY HIGHLANDS</div>
        <div class="tutorial-guide">
          <div class="tut-item" id="tut-jump">
            <div class="tut-icon" id="tut-jump-icon"></div>
            <div class="tut-label">JUMP</div>
          </div>
          <div class="tut-separator"></div>
          <div class="tut-item" id="tut-dash">
            <div class="tut-icon" id="tut-dash-icon"></div>
            <div class="tut-label">DASH</div>
          </div>
        </div>

        <div class="start-instruction">CLICK TO INITIATE</div>
      </div>

      <!-- Countdown Overlay -->
      <div id="countdown-overlay" class="screen-overlay"
        style="display:none; z-index: 9999; background: rgba(0,0,0,0.5);">
        <div id="countdown-text"
          style="font-size: 8rem; font-weight: 900; color: var(--neon-blue); text-shadow: 0 0 30px var(--neon-blue);">3
        </div>
      </div>

      <!-- Game Over -->
      <div id="message" class="game-over-overlay" style="display:none;">
        <div class="game-over-popup">
          <div class="game-over-header">GAME OVER</div>
          <div class="simple-stats">
            <div class="simple-stat-row">
              <span class="label">SCORE</span><span id="finalScore" class="value">0</span>
            </div>
            <div class="simple-stat-row">
              <span class="label">RECORD</span><span id="finalBest" class="value">0</span>
            </div>
            <div id="distance-row" class="simple-stat-row">
              <span class="label">MAX DISTANCE</span><span id="finalDist" class="value">0</span>
            </div>
            <div class="simple-stat-row">
              <span class="label">CREDITS</span><span id="finalCoins" class="value">0</span>
            </div>
          </div>
          <div class="modal-footer" style="flex-direction: column; gap: 0.8rem;">
            <button id="reviveBtn" class="btn-primary" style="width: 100%;">
              <span>QUICK REVIVE</span>
              <span id="revive-cost-tag">3$ ü™ô</span>
            </button>
            <button id="reviveAdBtn" class="btn-outline" style="width: 100%;">
              <span>FREE REVIVE (AD)</span>
            </button>
            <button id="restartBtn" class="btn-secondary" style="width: 100%;">RETRY</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Notification Popup (Central) -->
  <div id="notification-popup" class="notification-popup">
    <div class="notification-content">
      <div id="notif-icon" class="notif-text">‚úÖ</div>
      <div id="notif-message" class="notif-text">PURCHASE SUCCESSFUL</div>
    </div>
  </div>

  <!-- Custom Tooltip Node -->
  <div id="custom-tooltip"></div>

  <script type="module" src="/src/main.ts"></script>
</body>

</html>